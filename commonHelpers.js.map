{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '41971380-5e7df6cf95dc1cfc66e370c4e';\n\nconst refs = {\n  form: document.getElementById('search-form'),\n  resultContainer: document.getElementById('result-container'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n};\n\nconst hiddenClass = 'is-hidden';\nconst params = {\n  page: 1,\n  query: '',\n  maxPage: 0,\n  perPage: 40,\n};\n\nrefs.form.addEventListener('submit', handleSearch);\n\nfunction handleError(message) {\n  iziToast.error({\n    position: 'topRight',\n    message: message,\n  });\n}\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  refs.resultContainer.innerHTML = '';\n  params.page = 1;\n\n  refs.loader.classList.remove(hiddenClass);\n  refs.loadMoreBtn.classList.add(hiddenClass);\n  refs.loadMoreBtn.addEventListener('click', handleLoadMore);\n  const form = event.currentTarget;\n  params.query = form.elements.query.value.trim();\n\n  if (!params.query) {\n    refs.loader.classList.add(hiddenClass);\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await searchPicturesByParams(params);\n\n    if (hits.length === 0) {\n      handleError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    params.maxPage = Math.ceil(totalHits / params.perPage);\n\n    createMarkup(hits);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      refs.loadMoreBtn.classList.remove(hiddenClass);\n    }\n\n    if (params.page === params.maxPage) {\n      handleError(\"That's all we find!\");\n    }\n  } catch (err) {\n    handleError('Something wrong!');\n  } finally {\n    form.reset();\n    refs.loader.classList.add(hiddenClass);\n  }\n}\n\nasync function handleLoadMore() {\n  params.page += 1;\n  refs.loader.classList.remove(hiddenClass);\n  refs.loadMoreBtn.disabled = true;\n  try {\n    const { hits } = await searchPicturesByParams(params);\n\n    createMarkup(hits);\n    scrollDown();\n  } catch (err) {\n    handleError('Something wrong!');\n  } finally {\n    refs.loader.classList.add(hiddenClass);\n    refs.loadMoreBtn.disabled = false;\n  }\n  if (params.page === params.maxPage) {\n    refs.loadMoreBtn.classList.add(hiddenClass);\n    refs.loadMoreBtn.removeEventListener('click', handleLoadMore);\n\n    handleError(\"That's all we find!\");\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction searchPicturesByParams({ query, page = 1, perPage }) {\n  return axios\n    .get(`${BASE_URL}/`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: perPage,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nfunction createMarkup(hits) {\n  const markUp = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n  <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" heigth=\"200\"></a>\n  <div class=\"stats-block\">\n         <div class=\"stats\">\n             <h2 class=\"title\">Likes</h2>\n             <p class=\"amount\">${likes}</p>\n         </div>\n         <div class=\"stats\">\n             <h2 class=\"title\">Views</h2>\n             <p class=\"amount\">${views}</p>\n         </div>\n          <div class=\"stats\">\n              <h2 class=\"title\">Comments</h2>\n             <p class=\"amount\">${comments}</p>\n         </div>\n          <div class=\"stats\">\n             <h2 class=\"title\">Downloads</h2>\n             <p class=\"amount\">${downloads}</p>\n          </div>\n\n   </div>\n</li>`\n    )\n    .join('');\n  refs.resultContainer.insertAdjacentHTML('beforeend', markUp);\n  lightbox.refresh();\n}\n\nfunction scrollDown() {\n  if (params.page > 1) {\n    const scrollItem = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    window.scrollBy({\n      top: scrollItem.height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["BASE_URL","API_KEY","refs","hiddenClass","params","handleSearch","handleError","message","iziToast","event","handleLoadMore","form","hits","totalHits","searchPicturesByParams","createMarkup","scrollDown","lightbox","SimpleLightbox","query","page","perPage","axios","data","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","scrollItem"],"mappings":"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"}